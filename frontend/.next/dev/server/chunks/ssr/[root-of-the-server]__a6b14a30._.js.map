{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/alexisvanautgaerden/projects/CleanAirSafe/frontend/lib/api.ts"],"sourcesContent":["/**\n * üìñ API CLIENT\n * Client simple pour communiquer avec le backend\n */\n\nconst API_BASE = 'http://localhost:8000/api'\n\nasync function request(endpoint: string, options?: RequestInit) {\n  const url = `${API_BASE}${endpoint}`\n\n  const response = await fetch(url, {\n    ...options,\n    headers: {\n      'Content-Type': 'application/json',\n      ...options?.headers,\n    },\n  })\n\n  const data = await response.json()\n\n  if (!response.ok) {\n    throw new Error(data.error || 'Request failed')\n  }\n\n  return data\n}\n\nexport const api = {\n  // Sensors\n  getSensors: () => request('/sensors'),\n  getSensor: (id: string) => request(`/sensors/${id}`),\n  getSensorMeasurements: (id: string, params?: { limit?: number; offset?: number }) => {\n    const query = new URLSearchParams(params as any).toString()\n    return request(`/sensors/${id}/measurements${query ? `?${query}` : ''}`)\n  },\n\n  // Users\n  getUsers: () => request('/users'),\n  getUser: (id: string) => request(`/users/${id}`),\n  getUserHierarchy: (id: string) => request(`/users/${id}/hierarchy`),\n\n  // Spaces\n  getSpaces: () => request('/spaces'),\n  getSpace: (id: string) => request(`/spaces/${id}`),\n  getSpaceTree: (id: string) => request(`/spaces/${id}/tree`),\n\n  // Alerts\n  getAlerts: (params?: { status?: string; severity?: string }) => {\n    const query = new URLSearchParams(params as any).toString()\n    return request(`/alerts${query ? `?${query}` : ''}`)\n  },\n  getAlert: (id: string) => request(`/alerts/${id}`),\n\n  // Health\n  getHealth: () => request('/health'),\n}\n"],"names":[],"mappings":";;;;AAAA;;;CAGC,GAED,MAAM,WAAW;AAEjB,eAAe,QAAQ,QAAgB,EAAE,OAAqB;IAC5D,MAAM,MAAM,GAAG,WAAW,UAAU;IAEpC,MAAM,WAAW,MAAM,MAAM,KAAK;QAChC,GAAG,OAAO;QACV,SAAS;YACP,gBAAgB;YAChB,GAAG,SAAS,OAAO;QACrB;IACF;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;IAChC;IAEA,OAAO;AACT;AAEO,MAAM,MAAM;IACjB,UAAU;IACV,YAAY,IAAM,QAAQ;IAC1B,WAAW,CAAC,KAAe,QAAQ,CAAC,SAAS,EAAE,IAAI;IACnD,uBAAuB,CAAC,IAAY;QAClC,MAAM,QAAQ,IAAI,gBAAgB,QAAe,QAAQ;QACzD,OAAO,QAAQ,CAAC,SAAS,EAAE,GAAG,aAAa,EAAE,QAAQ,CAAC,CAAC,EAAE,OAAO,GAAG,IAAI;IACzE;IAEA,QAAQ;IACR,UAAU,IAAM,QAAQ;IACxB,SAAS,CAAC,KAAe,QAAQ,CAAC,OAAO,EAAE,IAAI;IAC/C,kBAAkB,CAAC,KAAe,QAAQ,CAAC,OAAO,EAAE,GAAG,UAAU,CAAC;IAElE,SAAS;IACT,WAAW,IAAM,QAAQ;IACzB,UAAU,CAAC,KAAe,QAAQ,CAAC,QAAQ,EAAE,IAAI;IACjD,cAAc,CAAC,KAAe,QAAQ,CAAC,QAAQ,EAAE,GAAG,KAAK,CAAC;IAE1D,SAAS;IACT,WAAW,CAAC;QACV,MAAM,QAAQ,IAAI,gBAAgB,QAAe,QAAQ;QACzD,OAAO,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC,EAAE,OAAO,GAAG,IAAI;IACrD;IACA,UAAU,CAAC,KAAe,QAAQ,CAAC,QAAQ,EAAE,IAAI;IAEjD,SAAS;IACT,WAAW,IAAM,QAAQ;AAC3B"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/alexisvanautgaerden/projects/CleanAirSafe/frontend/app/sensors/%5Bid%5D/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useParams, useRouter } from 'next/navigation'\nimport { api } from '@/lib/api'\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts'\n\nexport default function SensorDetailPage() {\n  const params = useParams()\n  const router = useRouter()\n  const [sensor, setSensor] = useState<any>(null)\n  const [measurements, setMeasurements] = useState<any[]>([])\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    if (!params.id) return\n\n    Promise.all([\n      api.getSensor(params.id as string),\n      api.getSensorMeasurements(params.id as string, { limit: 100 })\n    ])\n      .then(([sensorData, measurementsData]) => {\n        setSensor(sensorData.data)\n\n        // Formate les donn√©es pour le graphique\n        // Filtre les doublons et formate avec date + heure\n        const uniqueMeasurements = (measurementsData.data || [])\n          .filter((m: any, index: number, self: any[]) =>\n            index === self.findIndex((t) => t.timestamp === m.timestamp)\n          )\n          .reverse() // Plus ancien au plus r√©cent\n\n        const formattedData = uniqueMeasurements.map((m: any) => {\n          const date = new Date(m.timestamp)\n          return {\n            time: date.toLocaleString('fr-FR', {\n              month: '2-digit',\n              day: '2-digit',\n              hour: '2-digit',\n              minute: '2-digit'\n            }),\n            co2: m.co2Ppm,\n            temperature: m.temperature,\n            humidity: m.humidity\n          }\n        })\n\n        setMeasurements(formattedData)\n        setLoading(false)\n      })\n      .catch(error => {\n        console.error(error)\n        setLoading(false)\n      })\n  }, [params.id])\n\n  if (loading) {\n    return <div className=\"text-center py-12\">Chargement...</div>\n  }\n\n  if (!sensor) {\n    return <div className=\"text-center py-12\">Capteur non trouv√©</div>\n  }\n\n  const latestMeasurement = measurements[measurements.length - 1]\n\n  return (\n    <div className=\"px-4 sm:px-0\">\n      {/* En-t√™te avec bouton retour */}\n      <div className=\"mb-6\">\n        <button\n          onClick={() => router.back()}\n          className=\"text-sm text-gray-500 hover:text-gray-700 mb-2\"\n        >\n          ‚Üê Retour\n        </button>\n        <h1 className=\"text-3xl font-bold text-gray-900\">{sensor.name}</h1>\n        <p className=\"mt-2 text-sm text-gray-700\">\n          Device ID: {sensor.deviceId}\n        </p>\n      </div>\n\n      {/* Informations du capteur */}\n      <div className=\"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8\">\n        <InfoCard\n          title=\"Lieu\"\n          value={sensor.space?.name || 'Non assign√©'}\n          subtitle={sensor.space?.path}\n          color=\"blue\"\n        />\n        <InfoCard\n          title=\"Responsable\"\n          value={sensor.responsible?.name || 'Non assign√©'}\n          subtitle={sensor.responsible?.email}\n          color=\"green\"\n        />\n        <InfoCard\n          title=\"Status\"\n          value={sensor.status}\n          subtitle={`Seuil: ${sensor.thresholdWarning} ppm`}\n          color=\"purple\"\n        />\n        <InfoCard\n          title=\"Entreprise\"\n          value={sensor.company?.name || 'N/A'}\n          subtitle={sensor.company?.reference}\n          color=\"orange\"\n        />\n      </div>\n\n      {/* Mesures en temps r√©el */}\n      {latestMeasurement && (\n        <div className=\"bg-white shadow rounded-lg p-6 mb-8\">\n          <h2 className=\"text-lg font-medium text-gray-900 mb-4\">\n            Derni√®res mesures\n          </h2>\n          <div className=\"grid grid-cols-1 gap-5 sm:grid-cols-3\">\n            <MeasurementCard\n              title=\"CO2\"\n              value={latestMeasurement.co2}\n              unit=\"ppm\"\n              threshold={sensor.thresholdWarning}\n              color=\"blue\"\n            />\n            <MeasurementCard\n              title=\"Temp√©rature\"\n              value={latestMeasurement.temperature}\n              unit=\"¬∞C\"\n              color=\"orange\"\n            />\n            <MeasurementCard\n              title=\"Humidit√©\"\n              value={latestMeasurement.humidity}\n              unit=\"%\"\n              color=\"cyan\"\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Graphiques */}\n      <div className=\"bg-white shadow rounded-lg p-6 mb-8\">\n        <h2 className=\"text-lg font-medium text-gray-900 mb-4\">\n          Historique CO2 (derni√®res {measurements.length} mesures)\n        </h2>\n        <ResponsiveContainer width=\"100%\" height={300}>\n          <LineChart data={measurements}>\n            <CartesianGrid strokeDasharray=\"3 3\" />\n            <XAxis dataKey=\"time\" />\n            <YAxis />\n            <Tooltip />\n            <Legend />\n            <Line\n              type=\"monotone\"\n              dataKey=\"co2\"\n              stroke=\"#3b82f6\"\n              name=\"CO2 (ppm)\"\n              strokeWidth={2}\n              dot={{ fill: '#3b82f6', r: 4 }}\n              activeDot={{ r: 6 }}\n            />\n          </LineChart>\n        </ResponsiveContainer>\n      </div>\n\n      <div className=\"grid grid-cols-1 gap-5 lg:grid-cols-2 mb-8\">\n        {/* Graphique Temp√©rature */}\n        <div className=\"bg-white shadow rounded-lg p-6\">\n          <h2 className=\"text-lg font-medium text-gray-900 mb-4\">\n            Historique Temp√©rature\n          </h2>\n          <ResponsiveContainer width=\"100%\" height={250}>\n            <LineChart data={measurements}>\n              <CartesianGrid strokeDasharray=\"3 3\" />\n              <XAxis dataKey=\"time\" />\n              <YAxis />\n              <Tooltip />\n              <Legend />\n              <Line\n                type=\"monotone\"\n                dataKey=\"temperature\"\n                stroke=\"#f97316\"\n                name=\"Temp√©rature (¬∞C)\"\n                strokeWidth={2}\n                dot={{ fill: '#f97316', r: 4 }}\n                activeDot={{ r: 6 }}\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Graphique Humidit√© */}\n        <div className=\"bg-white shadow rounded-lg p-6\">\n          <h2 className=\"text-lg font-medium text-gray-900 mb-4\">\n            Historique Humidit√©\n          </h2>\n          <ResponsiveContainer width=\"100%\" height={250}>\n            <LineChart data={measurements}>\n              <CartesianGrid strokeDasharray=\"3 3\" />\n              <XAxis dataKey=\"time\" />\n              <YAxis />\n              <Tooltip />\n              <Legend />\n              <Line\n                type=\"monotone\"\n                dataKey=\"humidity\"\n                stroke=\"#06b6d4\"\n                name=\"Humidit√© (%)\"\n                strokeWidth={2}\n                dot={{ fill: '#06b6d4', r: 4 }}\n                activeDot={{ r: 6 }}\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction InfoCard({ title, value, subtitle, color }: any) {\n  const colors: any = {\n    blue: 'bg-blue-50 text-blue-700',\n    green: 'bg-green-50 text-green-700',\n    purple: 'bg-purple-50 text-purple-700',\n    orange: 'bg-orange-50 text-orange-700',\n  }\n\n  return (\n    <div className={`${colors[color]} overflow-hidden shadow rounded-lg px-4 py-5 sm:p-6`}>\n      <dt className=\"text-sm font-medium truncate\">{title}</dt>\n      <dd className=\"mt-1 text-2xl font-semibold\">{value}</dd>\n      {subtitle && (\n        <dd className=\"mt-1 text-sm opacity-75 truncate\">{subtitle}</dd>\n      )}\n    </div>\n  )\n}\n\nfunction MeasurementCard({ title, value, unit, threshold, color }: any) {\n  const colors: any = {\n    blue: 'border-blue-500',\n    orange: 'border-orange-500',\n    cyan: 'border-cyan-500',\n  }\n\n  const isWarning = threshold && value > threshold\n\n  return (\n    <div className={`border-l-4 ${colors[color]} bg-white p-4 rounded`}>\n      <dt className=\"text-sm font-medium text-gray-500\">{title}</dt>\n      <dd className={`mt-1 text-3xl font-semibold ${isWarning ? 'text-red-600' : 'text-gray-900'}`}>\n        {value?.toFixed(1)} <span className=\"text-lg text-gray-500\">{unit}</span>\n      </dd>\n      {isWarning && (\n        <dd className=\"mt-1 text-xs text-red-600\">‚ö†Ô∏è Seuil d√©pass√© ({threshold} {unit})</dd>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}